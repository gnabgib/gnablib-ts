// import { suite } from 'uvu';
// import * as assert from 'uvu/assert';
// import { hex } from '../../../src/encoding/Hex';
// import { XChaCha20 } from '../../../src/crypt/sym/ChaCha';
// import { U64 } from '../../../src/primitive/U64';


// const tsts = suite('XChaCha20');


// const testEnc:[string,string,string,number,string,string][]=[
//     //https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha-03
//     [
//         'Draft A.2.1',
//         '808182838485868788898A8B8C8D8E8F909192939495969798999A9B9C9D9E9F',
//         '404142434445464748494A4B4C4D4E4F5051525354555658',
//         0,
//         '5468652064686F6C65202870726F6E6F756E6365642022646F6C65222920697320616C736F206B6E6F776E2061732074686520417369617469632077696C6420646F672C2072656420646F672C20616E642077686973746C696E6720646F672E2049742069732061626F7574207468652073697A65206F662061204765726D616E20736865706865726420627574206C6F6F6B73206D6F7265206C696B652061206C6F6E672D6C656767656420666F782E205468697320686967686C7920656C757369766520616E6420736B696C6C6564206A756D70657220697320636C6173736966696564207769746820776F6C7665732C20636F796F7465732C206A61636B616C732C20616E6420666F78657320696E20746865207461786F6E6F6D69632066616D696C792043616E696461652E',
//         '4559ABBA4E48C16102E8BB2C05E6947F50A786DE162F9B0B7E592A9B53D0D4E98D8D6410D540A1A6375B26D80DACE4FAB52384C731ACBF16A5923C0C48D3575D4D0D2C673B666FAA731061277701093A6BF7A158A8864292A41C48E3A9B4C0DAECE0F8D98D0D7E05B37A307BBB66333164EC9E1B24EA0D6C3FFDDCEC4F68E7443056193A03C810E11344CA06D8ED8A2BFB1E8D48CFA6BC0EB4E2464B748142407C9F431AEE769960E15BA8B96890466EF2457599852385C661F752CE20F9DA0C09AB6B19DF74E76A95967446F8D0FD415E7BEE2A12A114C20EB5292AE7A349AE577820D5520A1F3FB62A17CE6A7E68FA7C79111D8860920BC048EF43FE84486CCB87C25F0AE045F0CCE1E7989A9AA220A28BDD4827E751A24A6D5C62D790A66393B93111C1A55DD7421A10184974C7C5'
//     ],

//     [
//         'Draft A.2.2',
//         '808182838485868788898A8B8C8D8E8F909192939495969798999A9B9C9D9E9F',
//         '404142434445464748494A4B4C4D4E4F5051525354555658',
//         1,
//         '5468652064686F6C65202870726F6E6F756E6365642022646F6C65222920697320616C736F206B6E6F776E2061732074686520417369617469632077696C6420646F672C2072656420646F672C20616E642077686973746C696E6720646F672E2049742069732061626F7574207468652073697A65206F662061204765726D616E20736865706865726420627574206C6F6F6B73206D6F7265206C696B652061206C6F6E672D6C656767656420666F782E205468697320686967686C7920656C757369766520616E6420736B696C6C6564206A756D70657220697320636C6173736966696564207769746820776F6C7665732C20636F796F7465732C206A61636B616C732C20616E6420666F78657320696E20746865207461786F6E6F6D69632066616D696C792043616E696461652E',
//         '7D0A2E6B7F7C65A236542630294E063B7AB9B555A5D5149AA21E4AE1E4FBCE87ECC8E08A8B5E350ABE622B2FFA617B202CFAD72032A3037E76FFDCDC4376EE053A190D7E46CA1DE04144850381B9CB29F051915386B8A710B8AC4D027B8B050F7CBA5854E028D564E453B8A968824173FC16488B8970CAC828F11AE53CABD20112F87107DF24EE6183D2274FE4C8B1485534EF2C5FBC1EC24BFC3663EFAA08BC047D29D25043532DB8391A8A3D776BF4372A6955827CCB0CDD4AF403A7CE4C63D595C75A43E045F0CCE1F29C8B93BD65AFC5974922F214A40B7C402CDB91AE73C0B63615CDAD0480680F16515A7ACE9D39236464328A37743FFC28F4DDB324F4D0F5BBDC270C65B1749A6EFFF1FBAA09536175CCD29FB9E6057B307320D316838A9C71F70B5B5907A66F7EA49AADC409'
//     ],

//     [
//         'Adaintum 0-0',
//         '8266851EC38621074F6F9E445E194D40147880FC21281E315D0B32DEE24D8A1E',
//         'C7CFE494E56C8F8CDF2C69A53E9E595393CA92CDADEE0259',
//         0,
//         '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
//         'C6F639EB103120123EE20B6FC4AAF316072B71D90A9384252164725113634663D4C685361DD5BA0510815E15C2E1A930A642FF04B90862816D727C19A145DAE1'
//     ],
//     [
//         'Adaintum 0-1',
//         '8266851EC38621074F6F9E445E194D40147880FC21281E315D0B32DEE24D8A1E',
//         'C7CFE494E56C8F8CDF2C69A53E9E595393CA92CDADEE0259',
//         1,
//         '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
//         'A35393848124C9EB3DB9D05BB642157CE032322E56D52B92BD4C0C466935CEFAF55175CE5B5BDC65EEC599B5759DC757A931F0E142387A375C9D81D753FFED74'
//     ],
//     [
//         'Adaintum 0-2',
//         '8266851EC38621074F6F9E445E194D40147880FC21281E315D0B32DEE24D8A1E',
//         'C7CFE494E56C8F8CDF2C69A53E9E595393CA92CDADEE0259',
//         1023,
//         '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
//         '5F0B9D82EAA125CC7E1474332C36A94F8088585BF58A733B1441C54FC9F990AA3376B76C5684AAE01F5FF4387B109FBFF14D1F57E72A2C42C27AE00528ACC15D'
//     ],
//     [
//         'Adaintum 0-4',
//         '8266851EC38621074F6F9E445E194D40147880FC21281E315D0B32DEE24D8A1E',
//         'C7CFE494E56C8F8CDF2C69A53E9E595393CA92CDADEE0259',
//         2048,
//         '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
//         '889BE5D7C37749038053DB79EDD7F3927B6B8C6FA59AB27842723F2A5FD42A53A2232FFBD075D9EC8ABE2E1F817E4EE1B0D5CCCA3CC4A18BEE71F6654A55B12D'
//     ],
//     [
//         'Adaintum 1-0',
//         '66CFF8D5A8C765691A92C8241C7A55A0A133AB455A0748DAB2B839F42AEE525B',
//         '76A3637217B9FA1227FC3C777CB2A76F7B43BD392FDE6DB7',
//         0,
//         '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
//         '2891B6708B2898BF97573D9C74F8BF7FCDA2812B63E5BEC77D910B63D408B765E0450C53A0ED75971F448A22C4199312CBDA52EC5E25C9758B87C2EED8E43033'
//     ],
//     [
//         'Adaintum 1-2',
//         '66CFF8D5A8C765691A92C8241C7A55A0A133AB455A0748DAB2B839F42AEE525B',
//         '76A3637217B9FA1227FC3C777CB2A76F7B43BD392FDE6DB7',
//         1023,
//         '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
//         '23026A6C07E1CB2A33C21CFD82DB5B9DA740DFEAA60AA1B6D3C1159D16101338E50CF605F69EE8087BB5FEA4A976CDCDB0292C02B6AC5B756887F5C8DDBF04EA'
//     ],
//     [
//         'Adaintum 1-4',
//         '66CFF8D5A8C765691A92C8241C7A55A0A133AB455A0748DAB2B839F42AEE525B',
//         '76A3637217B9FA1227FC3C777CB2A76F7B43BD392FDE6DB7',
//         2048,
//         '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
//         'A3F646A14736018EFAD66F4EE6BEF0E67FD167F95908B862A1260B944ABC3339C4436D09A38244488215F73AAB8379672C0C1CD82B17172F944BA978EC7624A0'
//     ],
// ];
// for(const [descr,key,nonce,counter,plain,enc] of testEnc) {
//     tsts(`enc(${descr})`,()=>{
//         const cc=new XChaCha20(hex.toBytes(key),hex.toBytes(nonce),counter);
//         const pBytes=hex.toBytes(plain);
//         const eBytes=new Uint8Array(pBytes.length);
//         cc.encryptInto(eBytes,pBytes);
//         assert.equal(hex.fromBytes(eBytes),enc);
//     });
//     tsts(`dec(${descr})`,()=>{
//         const cc=new XChaCha20(hex.toBytes(key),hex.toBytes(nonce),counter);
//         const eBytes=hex.toBytes(enc);
//         const pBytes=new Uint8Array(eBytes.length);
//         cc.decryptInto(pBytes,eBytes);
//         assert.equal(hex.fromBytes(pBytes),plain);
//     });
// }

// tsts.run();