import { suite } from 'uvu';
import * as assert from 'uvu/assert';
import * as utf8 from '../../src/encoding/Utf8';
import * as hex from '../../src/encoding/Hex';
import { sha3_224, sha3_256, sha3_384, sha3_512 } from '../../src/hash/Sha3';

const tsts = suite('SHA3/FIPS-202');

const ascii224Pairs = [
	['', '6B4E03423667DBB73B6E15454F0EB1ABD4597F9A1B078E3F5B5A6BC7'],
	//https://emn178.github.io/online-tools/sha3_224.html
	[
		'The quick brown fox jumps over the lazy dog',
		'D15DADCEAA4D5D7BB3B48F446421D542E08AD8887305E28D58335795',
	],
	[
		'The quick brown fox jumps over the lazy dog.',
		'2D0708903833AFABDD232A20201176E8B58C5BE8A6FE74265AC54DB0',
	],
	[
		'The quick brown fox jumps over the lazy cog',
		'B770EB6AC3AC52BD2F9E8DC186D6B604E7C3B7FFC8BD9220B0078CED',
	],
	[
		'12345678901234567890123456789012345678901234567890123456789012345678901234567890',
		'0526898E185869F91B3E2A76DD72A15DC6940A67C8164A044CD25CC8',
	],
	['gnabgib', 'E26FA59CBE1D34AC5AB8292030DC0791E805BF6AC48269E4D1023C79'],
];
const ascii256Pairs = [
	['', 'A7FFC6F8BF1ED76651C14756A061D662F580FF4DE43B49FA82D80A4B80F8434A'],
	//https://emn178.github.io/online-tools/sha3_256.html
	[
		'The quick brown fox jumps over the lazy dog',
		'69070DDA01975C8C120C3AADA1B282394E7F032FA9CF32F4CB2259A0897DFC04',
	],
	[
		'The quick brown fox jumps over the lazy dog.',
		'A80F839CD4F83F6C3DAFC87FEAE470045E4EB0D366397D5C6CE34BA1739F734D',
	],
	[
		'The quick brown fox jumps over the lazy cog',
		'CC80B0B13BA89613D93F02EE7CCBE72EE26C6EDFE577F22E63A1380221CAEDBC',
	],
	[
		'12345678901234567890123456789012345678901234567890123456789012345678901234567890',
		'293E5CE4CE54EE71990AB06E511B7CCD62722B1BEB414F5FF65C8274E0F5BE1D',
	],
	[
		'gnabgib',
		'1DBB11C686F835D4EA0D35B00957ED6B60E2442C47BC0A5D1D7D64984917248B',
	],
];
const ascii384Pairs = [
	//Source: https://en.wikipedia.org/wiki/SHA-2
	[
		'',
		'0C63A75B845E4F7D01107D852E4C2485C51A50AAAA94FC61995E71BBEE983A2AC3713831264ADB47FB6BD1E058D5F004',
	],
	//https://emn178.github.io/online-tools/sha3_384.html
	[
		'The quick brown fox jumps over the lazy dog',
		'7063465E08A93BCE31CD89D2E3CA8F602498696E253592ED26F07BF7E703CF328581E1471A7BA7AB119B1A9EBDF8BE41',
	],
	[
		'The quick brown fox jumps over the lazy dog.',
		'1A34D81695B622DF178BC74DF7124FE12FAC0F64BA5250B78B99C1273D4B080168E10652894ECAD5F1F4D5B965437FB9',
	],
	[
		'The quick brown fox jumps over the lazy cog',
		'E414797403C7D01AB64B41E90DF4165D59B7F147E4292BA2DA336ACBA242FD651949EB1CFFF7E9012E134B40981842E1',
	],
	[
		'12345678901234567890123456789012345678901234567890123456789012345678901234567890',
		'3C213A17F514638ACB3BF17F109F3E24C16F9F14F085B52A2F2B81ADC0DB83DF1A58DB2CE013191B8BA72D8FAE7E2A5E',
	],
	[
		'gnabgib',
		'A203DAAC1700A77F12FAB155B20F29DF46C3F1C2F7B8C85703E8FFBD254D813AD8151564A506D9BC4CA14A477EAAA6AA',
	],
];
const ascii512Pairs = [
	[
		'',
		'A69F73CCA23A9AC5C8B567DC185A756E97C982164FE25859E0D1DCC1475C80A615B2123AF1F5F94C11E3E9402C3AC558F500199D95B6D3E301758586281DCD26',
	],
	//https://emn178.github.io/online-tools/sha3_512.html
	[
		'The quick brown fox jumps over the lazy dog',
		'01DEDD5DE4EF14642445BA5F5B97C15E47B9AD931326E4B0727CD94CEFC44FFF23F07BF543139939B49128CAF436DC1BDEE54FCB24023A08D9403F9B4BF0D450',
	],
	[
		'The quick brown fox jumps over the lazy dog.',
		'18F4F4BD419603F95538837003D9D254C26C23765565162247483F65C50303597BC9CE4D289F21D1C2F1F458828E33DC442100331B35E7EB031B5D38BA6460F8',
	],
	[
		'The quick brown fox jumps over the lazy cog',
		'28E361FE8C56E617CAA56C28C7C36E5C13BE552B77081BE82B642F08BB7EF085B9A81910FE98269386B9AACFD2349076C9506126E198F6F6AD44C12017CA77B1',
	],
	[
		'12345678901234567890123456789012345678901234567890123456789012345678901234567890',
		'9524B9A5536B91069526B4F6196B7E9475B4DA69E01F0C855797F224CD7335DDB286FD99B9B32FFE33B59AD424CC1744F6EB59137F5FB8601932E8A8AF0AE930',
	],
	[
		'gnabgib',
		'4A45943D3AB7D094CAD3AD9D247FFA90C79CC5D5E5D782FC9CB5EDF209072358DAF98F33327C89C07C6F0E166F3FC491AD006336F6E3EDCBF1EB193D46669B92',
	],
];

for (const pair of ascii224Pairs) {
	tsts('SHA3-224:' + pair[0], () => {
		const b = utf8.toBytes(pair[0]);
		const m = sha3_224(b);
		assert.is(hex.fromBytes(m), pair[1]);
	});
}

for (const pair of ascii256Pairs) {
	tsts('SHA3-256:' + pair[0], () => {
		const b = utf8.toBytes(pair[0]);
		const m = sha3_256(b);
		assert.is(hex.fromBytes(m), pair[1]);
	});
}

for (const pair of ascii384Pairs) {
	tsts('SHA3-384:' + pair[0], () => {
		const b = utf8.toBytes(pair[0]);
		const m = sha3_384(b);
		assert.is(hex.fromBytes(m), pair[1]);
	});
}

for (const pair of ascii512Pairs) {
	tsts('SHA3-512:' + pair[0], () => {
		const b = utf8.toBytes(pair[0]);
		const m = sha3_512(b);
		assert.is(hex.fromBytes(m), pair[1]);
	});
}

tsts.run();
