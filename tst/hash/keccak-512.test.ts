import { suite } from 'uvu';
import * as assert from 'uvu/assert';
import * as utf8 from '../../src/encoding/Utf8';
import * as hex from '../../src/encoding/Hex';
import { Keccak512 } from '../../src/hash/Keccak';

const tsts = suite('Keccak (512)');

const ascii512Pairs = [
	[
		'',
		'0EAB42DE4C3CEB9235FC91ACFFE746B29C29A8C366B7C60E4E67C466F36A4304C00FA9CAF9D87976BA469BCBE06713B435F091EF2769FB160CDAB33D3670680E',
	],
	//!https://emn178.github.io/online-tools/keccak_512.html
	[
		'The quick brown fox jumps over the lazy dog',
		'D135BB84D0439DBAC432247EE573A23EA7D3C9DEB2A968EB31D47C4FB45F1EF4422D6C531B5B9BD6F449EBCC449EA94D0A8F05F62130FDA612DA53C79659F609',
	],
	[
		'The quick brown fox jumps over the lazy dog.',
		'AB7192D2B11F51C7DD744E7B3441FEBF397CA07BF812CCEAE122CA4DED6387889064F8DB9230F173F6D1AB6E24B6E50F065B039F799F5592360A6558EB52D760',
	],
	[
		'The quick brown fox jumps over the lazy cog',
		'10F8CAABB5B179861DA5E447D34B84D604E3EB81830880E1C2135FFC94580A47CB21F6243EC0053D58B1124D13AF2090033659075EE718E0F111BB3F69FB24CF',
	],
	[
		'12345678901234567890123456789012345678901234567890123456789012345678901234567890',
		'BC08A9A245E99F62753166A3226E874896DE0914565BEE0F8BE29D678E0DA66C508CC9948E8AD7BE78EAA4EDCED482253F8AB2E6768C9C8F2A2F0AFFF083D51C',
	],
	[
		'gnabgib',
		'D847956D2B7F648C4B1F28692C4EFAE4830D87423F8054A53C6AB528E2C71563381A9FA0B34610C2E95F4365C4816C2182C454275CB583BFEAD2CDC45BBD67F8',
	],
	//Test the transition over blocks
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz',
		'5AF8BA63ED19B376E1B6B7B8653D8B94B55F8DF9B846FBE8802266C9CDCF2F5F32A72650E1F3B2880C7CDA568E1887CBCD3643EE1BACFF784435120E330611E1',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0',
		'5C2E4679AF66314CD1626F15D5364BAEAE4D58A01145C9BCC9C10EB1D500B472A0969CD08064D4EB92CF18B6B6336D7104DC67E031CC9B24FCE81A042E9105E8',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01',
		'9B4D75E6F9303FEFBB6801B7B15635A7089B567C1D58FA6DBFB6BA397B1031D1B59453D198BB42D5AB8AE153C3E54F4A61102A5126039B1CFE955471A12749B0',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz012',
		'0AE638E15F1091446888AB87DB84A5016202C1F7AFB18F9454A351482899D228E4084DE644317C53A473A6D3424927D9DFBBEAD18A295F251B9DFC7E56EF062D',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123',
		'BB7B4C4D5DE2812170D255DCA3FB47389DCFB98F988E8F8DC193752F50F7EDE358F696279C4740BBB0C9A87F2502BBBC6A3430069C3C0495402B1F4E2EA0E257',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234',
		'67F45955DC061DFF76C6D80989E2C974AEC95D4EACE923AADF68788B6449C56D13CF24635023724F15619959D86FFABAFC4F67C9D9B9CAD910100E896E8A83FC',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz012345',
		'F4ECAF8BA8B9A64D3737E176F05E07C8D8E94B621B3C71813588D5861F4AFCA890ADE6C88A1D5AA1AC921FA68AF0CBF2CF5178C0FD1410F357DC3AC7AB937C5A',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456',
		'FEA29FECB2692AD49665A037D858C1E7BF89F257C5B24F6CD5CB13B49833A7516D60C8954D5ABBAD6CB1249B3F130A1D5A21434E5D51466A03FD5A094AB15B39',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234567',
		'7EE9BC767A1B86B3F25BB7BB0EDD12F4591A3172F9541FBC593DA072B069E6839DA35C46CC38444B618709640085D32E5CB742412AD4EF41B0428714BE5D449E',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz012345678',
		'639FBE06805134D325FE6CF3CB1F803F64FAD7A28C41FA5E8729B2BB40005C2FA430F863916D981ECB3E269BD30F412D6A871A0DAFC786662A142E7BA14AE1EF',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',
		'D5FA6B93D54A87BBDE52DBB44DAF96A3455DAEF9D60CDB922BC4B72A5BBBA97C5BF8C59816FEDE302FC64E98CE1B864DF7BE671C968E43D1BAE23AD76A3E702D',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789A',
		'04C4011F08437921B150E91C011CABC5A0B827531DDB3BAA0D29880209F9A4E47BECDA066CF7E477B568196BDD5566D5634B7D1364DACC8F5723EEED86D42556',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789AB',
		'E87952E14E2893D042CE89EA07012FB7A8CDD6771A6441F93D395AF059FF2DC39EAE13D3898CBC75C4CF4ACFB9642DB9A36EC5BDA784076D94D4DB3E587E12AD',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABC',
		'D72382FC42303D173B77AE35B7EA39EB0CAFE5752974FC28A9E56052E2287215072BA7C699405A3A81C82042DA3F4725205D52252C1DDD077176FC07D9C81371',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCD',
		'F3DC5A0F76C6B3B1B446FE8497C345D731859F376818F99FD958C27956CF5A18A00EF61954D3D1BE6C9CDB86B17CE36FAE07823AD2BF9D6E6D854B43B7E8F8B5',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDE',
		'28FDAF90E87233B817A7B2244C3FEA92EF6F1D85BEA320E76030943CC46555DF9FF2CC7495CF594F3DED2369E616ADD197F148C6D6D68440871B01F8F1F93840',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEF',
		'0A77BF21B42CB63F275E5394862384AB11FDAE4B1F7FF7B6BCF73015A98596F2FCC1860CD7F6E652391E33FC326D100CCB997D1F23E81669807EA421535BA5C5',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFG',
		'32D3985885FE784C239EF1B91870B108472C5813A7206DF099C303E6EA3F2926CC48D41D521600EAB76EEC9FE1CC5564FF6F7A4117F64C8C2F64EE5A86CE722B',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGH',
		'A239DDB48D4F8A6BD4ACF9C4F66742A749E38C3C9774F4632DCF18D04CE2E44F976C10BED2EDF6B84E95CB037B191E897DA721F809B0893C94A331DA4D3A9281',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHI',
		'27A3BC15B41F0F255E013BEB9BAA1C6B17EA5CF6BA70C1C6B07FD7167C8ABB72D39270E34E3CE5925B2934A94D969CB8F9B6CB1974F1517D446C0A38F7A5D426',
	],
	/*Exact block size*/
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJ',
		'2F03F3C7724A8CA537D6F102B334D13F0E8109898CFB6D38D3C00342197B15AE875906977ECA6E7011F0978AC606E8EE95AF4A8B55102D594C0D4E07742EA7CA',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJK',
		'DC49983542A884909B0ADBD0398D0C33A584029F1E67F09D3E9C31DC602BD73C1072669B9F3F1B381B2A28CBDC881295662F10ACBD18D3D917E27C589FDC8093',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKL',
		'04A0EEB901AEEA94A5FA5F5515A946A5B4B585EFA9D3518DCDB566FEFA53CECB9E4EB8DDED214987996027B7E7BEE5F490B1CA92C42A6DF270DD3C69DB4C790A',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLM',
		'E2D73F0FE79AAEDB02978DF5F5975505A98AD4DE57AA7563C91E7F072741CA4CAEFA9475AA6671F9FCD1792560F2A80AFE3734F6E5694673E623365122EC1AEE',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMN',
		'5FA7FE40C8A19CE27B0A2B8F39C527A0E1544FEC32F82684F6E5E76706200921B06630067BBA74D6636D1C62792F91743F74AC48235238BF33D4724B83453E7A',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNO',
		'32850CAF1DC8C52C23C300AD69A67C82A0F918700B0134ED9639C10B2CD66AD1BB4F662A5DE723A83E049E69A234EA73CE2D78636D241FDF36A5FC6B15DDEB81',
	],
	[
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOP',
		'D88505ECA52A2D2C11EF505E87104FF2CA2B571217139DF03910F4EE84819FF6E855830DD41E766B845B0EBF7E3B97B44361CBA63F3C8BB86E2F884C1DD6AAC1',
	],
];

for (const [source,expect] of ascii512Pairs) {
	const b = utf8.toBytes(source);
	tsts('Keccak512:' + source, () => {
		const hash=new Keccak512();
		hash.write(b);
		const md=hash.sum();
		assert.is(hex.fromBytes(md), expect);
        assert.is(hash.size,64);
	});
}

tsts.run();
